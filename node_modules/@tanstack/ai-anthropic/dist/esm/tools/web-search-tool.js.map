{"version":3,"file":"web-search-tool.js","sources":["../../../src/tools/web-search-tool.ts"],"sourcesContent":["import type { WebSearchTool20250305 } from '@anthropic-ai/sdk/resources/messages'\nimport type { CacheControl } from '../text/text-provider-options'\nimport type { Tool } from '@tanstack/ai'\n\nexport type WebSearchTool = WebSearchTool20250305\n\nconst validateDomains = (tool: WebSearchTool) => {\n  if (tool.allowed_domains && tool.blocked_domains) {\n    throw new Error(\n      'allowed_domains and blocked_domains cannot be used together.',\n    )\n  }\n}\n\nconst validateUserLocation = (tool: WebSearchTool) => {\n  const userLocation = tool.user_location\n  if (userLocation) {\n    if (\n      userLocation.city &&\n      (userLocation.city.length < 1 || userLocation.city.length > 255)\n    ) {\n      throw new Error(\n        'user_location.city must be between 1 and 255 characters.',\n      )\n    }\n    if (userLocation.country && userLocation.country.length !== 2) {\n      throw new Error('user_location.country must be exactly 2 characters.')\n    }\n    if (\n      userLocation.region &&\n      (userLocation.region.length < 1 || userLocation.region.length > 255)\n    ) {\n      throw new Error(\n        'user_location.region must be between 1 and 255 characters.',\n      )\n    }\n    if (\n      userLocation.timezone &&\n      (userLocation.timezone.length < 1 || userLocation.timezone.length > 255)\n    ) {\n      throw new Error(\n        'user_location.timezone must be between 1 and 255 characters.',\n      )\n    }\n  }\n}\n\nexport function convertWebSearchToolToAdapterFormat(tool: Tool): WebSearchTool {\n  const metadata = tool.metadata as {\n    allowedDomains?: Array<string> | null\n    blockedDomains?: Array<string> | null\n    maxUses?: number | null\n    userLocation?: {\n      type: 'approximate'\n      city?: string | null\n      country?: string | null\n      region?: string | null\n      timezone?: string | null\n    } | null\n    cacheControl?: CacheControl | null\n  }\n  return {\n    name: 'web_search',\n    type: 'web_search_20250305',\n    allowed_domains: metadata.allowedDomains,\n    blocked_domains: metadata.blockedDomains,\n    max_uses: metadata.maxUses,\n    user_location: metadata.userLocation,\n    cache_control: metadata.cacheControl || null,\n  }\n}\n\nexport function webSearchTool(config: WebSearchTool): Tool {\n  validateDomains(config)\n  validateUserLocation(config)\n  return {\n    name: 'web_search',\n    description: '',\n    metadata: config,\n  }\n}\n"],"names":[],"mappings":"AA+CO,SAAS,oCAAoC,MAA2B;AAC7E,QAAM,WAAW,KAAK;AAatB,SAAO;AAAA,IACL,MAAM;AAAA,IACN,MAAM;AAAA,IACN,iBAAiB,SAAS;AAAA,IAC1B,iBAAiB,SAAS;AAAA,IAC1B,UAAU,SAAS;AAAA,IACnB,eAAe,SAAS;AAAA,IACxB,eAAe,SAAS,gBAAgB;AAAA,EAAA;AAE5C;"}