{"version":3,"file":"image-provider-options.js","sources":["../../../src/image/image-provider-options.ts"],"sourcesContent":["/**\n * OpenAI Image Generation Provider Options\n *\n * These are provider-specific options for OpenAI image generation.\n * Common options like prompt, numberOfImages, and size are handled\n * in the base ImageGenerationOptions.\n */\n\n/**\n * Quality options for gpt-image-1 and gpt-image-1-mini models\n */\nexport type GptImageQuality = 'high' | 'medium' | 'low' | 'auto'\n\n/**\n * Quality options for dall-e-3 model\n */\nexport type DallE3Quality = 'hd' | 'standard'\n\n/**\n * Quality options for dall-e-2 model (only standard is supported)\n */\nexport type DallE2Quality = 'standard'\n\n/**\n * Style options for dall-e-3 model\n */\nexport type DallE3Style = 'vivid' | 'natural'\n\n/**\n * Output format options for gpt-image-1 models\n */\nexport type GptImageOutputFormat = 'png' | 'jpeg' | 'webp'\n\n/**\n * Response format options for dall-e models\n */\nexport type DallEResponseFormat = 'url' | 'b64_json'\n\n/**\n * Background options for gpt-image-1 models\n */\nexport type GptImageBackground = 'transparent' | 'opaque' | 'auto'\n\n/**\n * Moderation level for gpt-image-1 models\n */\nexport type GptImageModeration = 'low' | 'auto'\n\n/**\n * Supported sizes for gpt-image-1 models\n */\nexport type GptImageSize = '1024x1024' | '1536x1024' | '1024x1536' | 'auto'\n\n/**\n * Supported sizes for dall-e-3 model\n */\nexport type DallE3Size = '1024x1024' | '1792x1024' | '1024x1792'\n\n/**\n * Supported sizes for dall-e-2 model\n */\nexport type DallE2Size = '256x256' | '512x512' | '1024x1024'\n\n/**\n * Base provider options shared across all OpenAI image models\n */\nexport interface OpenAIImageBaseProviderOptions {\n  /**\n   * A unique identifier representing your end-user.\n   * Can help OpenAI to monitor and detect abuse.\n   */\n  user?: string\n}\n\n/**\n * Provider options for gpt-image-1 model\n * Field names match the OpenAI API for direct spreading\n */\nexport interface GptImage1ProviderOptions extends OpenAIImageBaseProviderOptions {\n  /**\n   * The quality of the image.\n   * @default 'auto'\n   */\n  quality?: GptImageQuality\n\n  /**\n   * Background transparency setting.\n   * When 'transparent', output format must be 'png' or 'webp'.\n   * @default 'auto'\n   */\n  background?: GptImageBackground\n\n  /**\n   * Output image format.\n   * @default 'png'\n   */\n  output_format?: GptImageOutputFormat\n\n  /**\n   * Compression level (0-100%) for webp/jpeg formats.\n   * @default 100\n   */\n  output_compression?: number\n\n  /**\n   * Content moderation level.\n   * @default 'auto'\n   */\n  moderation?: GptImageModeration\n\n  /**\n   * Number of partial images to generate during streaming (0-3).\n   * Only used when stream: true.\n   * @default 0\n   */\n  partial_images?: number\n}\n\n/**\n * Provider options for gpt-image-1-mini model\n * Same as gpt-image-1\n */\nexport type GptImage1MiniProviderOptions = GptImage1ProviderOptions\n\n/**\n * Provider options for dall-e-3 model\n * Field names match the OpenAI API for direct spreading\n */\nexport interface DallE3ProviderOptions extends OpenAIImageBaseProviderOptions {\n  /**\n   * The quality of the image.\n   * @default 'standard'\n   */\n  quality?: DallE3Quality\n\n  /**\n   * The style of the generated images.\n   * 'vivid' causes the model to lean towards generating hyper-real and dramatic images.\n   * 'natural' causes the model to produce more natural, less hyper-real looking images.\n   * @default 'vivid'\n   */\n  style?: DallE3Style\n\n  /**\n   * The format in which generated images are returned.\n   * URLs are only valid for 60 minutes after generation.\n   * @default 'url'\n   */\n  response_format?: DallEResponseFormat\n}\n\n/**\n * Provider options for dall-e-2 model\n * Field names match the OpenAI API for direct spreading\n */\nexport interface DallE2ProviderOptions extends OpenAIImageBaseProviderOptions {\n  /**\n   * The quality of the image (only 'standard' is supported).\n   */\n  quality?: DallE2Quality\n\n  /**\n   * The format in which generated images are returned.\n   * URLs are only valid for 60 minutes after generation.\n   * @default 'url'\n   */\n  response_format?: DallEResponseFormat\n}\n\n/**\n * Union of all OpenAI image provider options\n */\nexport type OpenAIImageProviderOptions =\n  | GptImage1ProviderOptions\n  | GptImage1MiniProviderOptions\n  | DallE3ProviderOptions\n  | DallE2ProviderOptions\n\n/**\n * Type-only map from model name to its specific provider options.\n * Used by the core AI types to narrow providerOptions based on the selected model.\n */\nexport type OpenAIImageModelProviderOptionsByName = {\n  'gpt-image-1': GptImage1ProviderOptions\n  'gpt-image-1-mini': GptImage1MiniProviderOptions\n  'dall-e-3': DallE3ProviderOptions\n  'dall-e-2': DallE2ProviderOptions\n}\n\n/**\n * Type-only map from model name to its supported sizes.\n */\nexport type OpenAIImageModelSizeByName = {\n  'gpt-image-1': GptImageSize\n  'gpt-image-1-mini': GptImageSize\n  'dall-e-3': DallE3Size\n  'dall-e-2': DallE2Size\n}\n\n/**\n * Internal options interface for validation\n */\ninterface ImageValidationOptions {\n  prompt: string\n  model: string\n  background?: 'transparent' | 'opaque' | 'auto' | null\n}\n\n/**\n * Validates that the provided size is supported by the model.\n * Throws a descriptive error if the size is not supported.\n */\nexport function validateImageSize(\n  model: string,\n  size: string | undefined,\n): void {\n  if (!size || size === 'auto') return\n\n  const validSizes: Record<string, Array<string>> = {\n    'gpt-image-1': ['1024x1024', '1536x1024', '1024x1536', 'auto'],\n    'gpt-image-1-mini': ['1024x1024', '1536x1024', '1024x1536', 'auto'],\n    'dall-e-3': ['1024x1024', '1792x1024', '1024x1792'],\n    'dall-e-2': ['256x256', '512x512', '1024x1024'],\n  }\n\n  const modelSizes = validSizes[model]\n  if (!modelSizes) {\n    throw new Error(`Unknown image model: ${model}`)\n  }\n\n  if (!modelSizes.includes(size)) {\n    throw new Error(\n      `Size \"${size}\" is not supported by model \"${model}\". ` +\n        `Supported sizes: ${modelSizes.join(', ')}`,\n    )\n  }\n}\n\n/**\n * Validates that the number of images is within bounds for the model.\n */\nexport function validateNumberOfImages(\n  model: string,\n  numberOfImages: number | undefined,\n): void {\n  if (numberOfImages === undefined) return\n\n  // dall-e-3 only supports n=1\n  if (model === 'dall-e-3' && numberOfImages !== 1) {\n    throw new Error(\n      `Model \"dall-e-3\" only supports generating 1 image at a time. ` +\n        `Requested: ${numberOfImages}`,\n    )\n  }\n\n  // Other models support 1-10\n  if (numberOfImages < 1 || numberOfImages > 10) {\n    throw new Error(\n      `Number of images must be between 1 and 10. Requested: ${numberOfImages}`,\n    )\n  }\n}\n\nexport const validateBackground = (options: ImageValidationOptions) => {\n  if (options.background) {\n    const supportedModels = ['gpt-image-1', 'gpt-image-1-mini']\n    if (!supportedModels.includes(options.model)) {\n      throw new Error(\n        `The model ${options.model} does not support background option.`,\n      )\n    }\n  }\n}\n\nexport const validatePrompt = (options: ImageValidationOptions) => {\n  if (options.prompt.length === 0) {\n    throw new Error('Prompt cannot be empty.')\n  }\n  if (\n    (options.model === 'gpt-image-1' || options.model === 'gpt-image-1-mini') &&\n    options.prompt.length > 32000\n  ) {\n    throw new Error(\n      'For gpt-image-1/gpt-image-1-mini, prompt length must be less than or equal to 32000 characters.',\n    )\n  }\n  if (options.model === 'dall-e-2' && options.prompt.length > 1000) {\n    throw new Error(\n      'For dall-e-2, prompt length must be less than or equal to 1000 characters.',\n    )\n  }\n  if (options.model === 'dall-e-3' && options.prompt.length > 4000) {\n    throw new Error(\n      'For dall-e-3, prompt length must be less than or equal to 4000 characters.',\n    )\n  }\n}\n"],"names":[],"mappings":"AAoNO,SAAS,kBACd,OACA,MACM;AACN,MAAI,CAAC,QAAQ,SAAS,OAAQ;AAE9B,QAAM,aAA4C;AAAA,IAChD,eAAe,CAAC,aAAa,aAAa,aAAa,MAAM;AAAA,IAC7D,oBAAoB,CAAC,aAAa,aAAa,aAAa,MAAM;AAAA,IAClE,YAAY,CAAC,aAAa,aAAa,WAAW;AAAA,IAClD,YAAY,CAAC,WAAW,WAAW,WAAW;AAAA,EAAA;AAGhD,QAAM,aAAa,WAAW,KAAK;AACnC,MAAI,CAAC,YAAY;AACf,UAAM,IAAI,MAAM,wBAAwB,KAAK,EAAE;AAAA,EACjD;AAEA,MAAI,CAAC,WAAW,SAAS,IAAI,GAAG;AAC9B,UAAM,IAAI;AAAA,MACR,SAAS,IAAI,gCAAgC,KAAK,uBAC5B,WAAW,KAAK,IAAI,CAAC;AAAA,IAAA;AAAA,EAE/C;AACF;AAKO,SAAS,uBACd,OACA,gBACM;AACN,MAAI,mBAAmB,OAAW;AAGlC,MAAI,UAAU,cAAc,mBAAmB,GAAG;AAChD,UAAM,IAAI;AAAA,MACR,2EACgB,cAAc;AAAA,IAAA;AAAA,EAElC;AAGA,MAAI,iBAAiB,KAAK,iBAAiB,IAAI;AAC7C,UAAM,IAAI;AAAA,MACR,yDAAyD,cAAc;AAAA,IAAA;AAAA,EAE3E;AACF;AAaO,MAAM,iBAAiB,CAAC,YAAoC;AACjE,MAAI,QAAQ,OAAO,WAAW,GAAG;AAC/B,UAAM,IAAI,MAAM,yBAAyB;AAAA,EAC3C;AACA,OACG,QAAQ,UAAU,iBAAiB,QAAQ,UAAU,uBACtD,QAAQ,OAAO,SAAS,MACxB;AACA,UAAM,IAAI;AAAA,MACR;AAAA,IAAA;AAAA,EAEJ;AACA,MAAI,QAAQ,UAAU,cAAc,QAAQ,OAAO,SAAS,KAAM;AAChE,UAAM,IAAI;AAAA,MACR;AAAA,IAAA;AAAA,EAEJ;AACA,MAAI,QAAQ,UAAU,cAAc,QAAQ,OAAO,SAAS,KAAM;AAChE,UAAM,IAAI;AAAA,MACR;AAAA,IAAA;AAAA,EAEJ;AACF;"}