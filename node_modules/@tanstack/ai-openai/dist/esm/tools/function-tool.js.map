{"version":3,"file":"function-tool.js","sources":["../../../src/tools/function-tool.ts"],"sourcesContent":["import { makeOpenAIStructuredOutputCompatible } from '../utils/schema-converter'\nimport type { JSONSchema, Tool } from '@tanstack/ai'\nimport type OpenAI from 'openai'\n\nexport type FunctionTool = OpenAI.Responses.FunctionTool\n\n/**\n * Converts a standard Tool to OpenAI FunctionTool format.\n *\n * Tool schemas are already converted to JSON Schema in the ai layer.\n * We apply OpenAI-specific transformations for strict mode:\n * - All properties in required array\n * - Optional fields made nullable\n * - additionalProperties: false\n *\n * This enables strict mode for all tools automatically.\n */\nexport function convertFunctionToolToAdapterFormat(tool: Tool): FunctionTool {\n  // Tool schemas are already converted to JSON Schema in the ai layer\n  // Apply OpenAI-specific transformations for strict mode\n  const inputSchema = (tool.inputSchema ?? {\n    type: 'object',\n    properties: {},\n    required: [],\n  }) as JSONSchema\n\n  const jsonSchema = makeOpenAIStructuredOutputCompatible(\n    inputSchema,\n    inputSchema.required || [],\n  )\n\n  // Ensure additionalProperties is false for strict mode\n  jsonSchema.additionalProperties = false\n\n  return {\n    type: 'function',\n    name: tool.name,\n    description: tool.description,\n    parameters: jsonSchema,\n    strict: true, // Always use strict mode since our schema converter handles the requirements\n  } satisfies FunctionTool\n}\n"],"names":[],"mappings":";AAiBO,SAAS,mCAAmC,MAA0B;AAG3E,QAAM,cAAe,KAAK,eAAe;AAAA,IACvC,MAAM;AAAA,IACN,YAAY,CAAA;AAAA,IACZ,UAAU,CAAA;AAAA,EAAC;AAGb,QAAM,aAAa;AAAA,IACjB;AAAA,IACA,YAAY,YAAY,CAAA;AAAA,EAAC;AAI3B,aAAW,uBAAuB;AAElC,SAAO;AAAA,IACL,MAAM;AAAA,IACN,MAAM,KAAK;AAAA,IACX,aAAa,KAAK;AAAA,IAClB,YAAY;AAAA,IACZ,QAAQ;AAAA;AAAA,EAAA;AAEZ;"}