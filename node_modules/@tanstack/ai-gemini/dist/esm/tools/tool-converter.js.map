{"version":3,"file":"tool-converter.js","sources":["../../../src/tools/tool-converter.ts"],"sourcesContent":["import { convertCodeExecutionToolToAdapterFormat } from './code-execution-tool'\nimport { convertComputerUseToolToAdapterFormat } from './computer-use-tool'\nimport { convertFileSearchToolToAdapterFormat } from './file-search-tool'\nimport { convertGoogleMapsToolToAdapterFormat } from './google-maps-tool'\nimport { convertGoogleSearchRetrievalToolToAdapterFormat } from './google-search-retriveal-tool'\nimport { convertGoogleSearchToolToAdapterFormat } from './google-search-tool'\nimport { convertUrlContextToolToAdapterFormat } from './url-context-tool'\nimport type { Tool } from '@tanstack/ai'\nimport type { ToolUnion } from '@google/genai'\n\n/**\n * Converts standard Tool format to Gemini-specific tool format\n *\n * @param tools - Array of standard Tool objects\n * @returns Array of Gemini-specific tool definitions\n *\n * @example\n * ```typescript\n * const tools: Tool[] = [{\n *   name: \"get_weather\",\n *   description: \"Get weather for a location\",\n *   inputSchema: z.object({\n *     location: z.string()\n *   })\n * }];\n *\n * const geminiTools = convertToolsToProviderFormat(tools);\n * ```\n */\nexport function convertToolsToProviderFormat<TTool extends Tool>(\n  tools: Array<TTool> | undefined,\n): Array<ToolUnion> {\n  if (!tools || tools.length === 0) {\n    return []\n  }\n  const result: Array<ToolUnion> = []\n  const functionDeclarations: Array<{\n    name: string\n    description?: string\n    parameters?: any\n  }> = []\n\n  // Process each tool and group function declarations together\n  for (const tool of tools) {\n    const name = tool.name\n\n    switch (name) {\n      case 'code_execution':\n        result.push(convertCodeExecutionToolToAdapterFormat(tool))\n        break\n      case 'computer_use':\n        result.push(convertComputerUseToolToAdapterFormat(tool))\n        break\n      case 'file_search':\n        result.push(convertFileSearchToolToAdapterFormat(tool))\n        break\n      case 'google_maps':\n        result.push(convertGoogleMapsToolToAdapterFormat(tool))\n        break\n      case 'google_search_retrieval':\n        result.push(convertGoogleSearchRetrievalToolToAdapterFormat(tool))\n        break\n      case 'google_search':\n        result.push(convertGoogleSearchToolToAdapterFormat(tool))\n        break\n      case 'url_context':\n        result.push(convertUrlContextToolToAdapterFormat(tool))\n        break\n      default:\n        // Collect function declarations to group together\n        // Description is required for Gemini function declarations\n        if (!tool.description) {\n          throw new Error(\n            `Tool ${tool.name} requires a description for Gemini adapter`,\n          )\n        }\n\n        // Tool schemas are already converted to JSON Schema in the ai layer\n        functionDeclarations.push({\n          name: tool.name,\n          description: tool.description,\n          parameters: tool.inputSchema ?? {\n            type: 'object',\n            properties: {},\n            required: [],\n          },\n        })\n        break\n    }\n  }\n\n  // If we have function declarations, add them as a single tool\n  if (functionDeclarations.length > 0) {\n    result.push({\n      functionDeclarations: functionDeclarations,\n    })\n  }\n\n  return result\n}\n"],"names":[],"mappings":";;;;;;;AA6BO,SAAS,6BACd,OACkB;AAClB,MAAI,CAAC,SAAS,MAAM,WAAW,GAAG;AAChC,WAAO,CAAA;AAAA,EACT;AACA,QAAM,SAA2B,CAAA;AACjC,QAAM,uBAID,CAAA;AAGL,aAAW,QAAQ,OAAO;AACxB,UAAM,OAAO,KAAK;AAElB,YAAQ,MAAA;AAAA,MACN,KAAK;AACH,eAAO,KAAK,wCAA4C,CAAC;AACzD;AAAA,MACF,KAAK;AACH,eAAO,KAAK,sCAAsC,IAAI,CAAC;AACvD;AAAA,MACF,KAAK;AACH,eAAO,KAAK,qCAAqC,IAAI,CAAC;AACtD;AAAA,MACF,KAAK;AACH,eAAO,KAAK,qCAAqC,IAAI,CAAC;AACtD;AAAA,MACF,KAAK;AACH,eAAO,KAAK,gDAAgD,IAAI,CAAC;AACjE;AAAA,MACF,KAAK;AACH,eAAO,KAAK,uCAAuC,IAAI,CAAC;AACxD;AAAA,MACF,KAAK;AACH,eAAO,KAAK,qCAAyC,CAAC;AACtD;AAAA,MACF;AAGE,YAAI,CAAC,KAAK,aAAa;AACrB,gBAAM,IAAI;AAAA,YACR,QAAQ,KAAK,IAAI;AAAA,UAAA;AAAA,QAErB;AAGA,6BAAqB,KAAK;AAAA,UACxB,MAAM,KAAK;AAAA,UACX,aAAa,KAAK;AAAA,UAClB,YAAY,KAAK,eAAe;AAAA,YAC9B,MAAM;AAAA,YACN,YAAY,CAAA;AAAA,YACZ,UAAU,CAAA;AAAA,UAAC;AAAA,QACb,CACD;AACD;AAAA,IAAA;AAAA,EAEN;AAGA,MAAI,qBAAqB,SAAS,GAAG;AACnC,WAAO,KAAK;AAAA,MACV;AAAA,IAAA,CACD;AAAA,EACH;AAEA,SAAO;AACT;"}