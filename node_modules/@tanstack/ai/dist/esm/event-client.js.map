{"version":3,"file":"event-client.js","sources":["../../src/event-client.ts"],"sourcesContent":["import { EventClient } from '@tanstack/devtools-event-client'\nimport type { MessagePart, ToolCall } from './types'\n\n/**\n * Tool call states - track the lifecycle of a tool call\n * Must match @tanstack/ai-client ToolCallState\n */\nexport type ToolCallState =\n  | 'awaiting-input' // Received start but no arguments yet\n  | 'input-streaming' // Partial arguments received\n  | 'input-complete' // All arguments received\n  | 'approval-requested' // Waiting for user approval\n  | 'approval-responded' // User has approved/denied\n\n/**\n * Tool result states - track the lifecycle of a tool result\n * Must match @tanstack/ai-client ToolResultState\n */\nexport type ToolResultState =\n  | 'streaming' // Placeholder for future streamed output\n  | 'complete' // Result is complete\n  | 'error' // Error occurred\n\nexport interface TokenUsage {\n  promptTokens: number\n  completionTokens: number\n  totalTokens: number\n}\n\nexport interface ImageUsage {\n  inputTokens?: number\n  outputTokens?: number\n  totalTokens?: number\n}\n\ninterface BaseEventContext {\n  timestamp: number\n  requestId?: string\n  streamId?: string\n  messageId?: string\n  clientId?: string\n  source?: 'client' | 'server'\n  provider?: string\n  model?: string\n  systemPrompts?: Array<string>\n  options?: Record<string, unknown>\n  modelOptions?: Record<string, unknown>\n  toolNames?: Array<string>\n  messageCount?: number\n  hasTools?: boolean\n  streaming?: boolean\n}\n\n// ===========================\n// Text Events\n// ===========================\n\n/** Emitted when a text request starts execution. */\nexport interface TextRequestStartedEvent extends BaseEventContext {\n  requestId: string\n  streamId: string\n  provider: string\n  model: string\n  messageCount: number\n  hasTools: boolean\n  streaming: boolean\n}\n\n/** Emitted when a text request completes with final output. */\nexport interface TextRequestCompletedEvent extends BaseEventContext {\n  requestId: string\n  streamId: string\n  provider: string\n  model: string\n  content: string\n  finishReason?: string\n  usage?: TokenUsage\n  duration?: number\n  streaming: boolean\n  messageCount: number\n  hasTools: boolean\n}\n\n/** Emitted when a message is created (user/assistant/system/tool). */\nexport interface TextMessageCreatedEvent extends BaseEventContext {\n  requestId?: string\n  streamId?: string\n  messageId: string\n  role: 'user' | 'assistant' | 'system' | 'tool'\n  content: string\n  parts?: Array<MessagePart>\n  toolCalls?: Array<ToolCall>\n  messageIndex?: number\n}\n\n/** Emitted when a user message is created (full content). */\nexport interface TextMessageUserEvent extends TextMessageCreatedEvent {\n  role: 'user'\n}\n\n/** Emitted for streaming text content chunks. */\nexport interface TextChunkContentEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  content: string\n  delta?: string\n}\n\n/** Emitted for streaming tool call chunks. */\nexport interface TextChunkToolCallEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  toolCallId: string\n  toolName: string\n  index: number\n  arguments: string\n}\n\n/** Emitted for streaming tool result chunks. */\nexport interface TextChunkToolResultEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  toolCallId: string\n  result: string\n}\n\n/** Emitted for streaming thinking chunks. */\nexport interface TextChunkThinkingEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  content: string\n  delta?: string\n}\n\n/** Emitted when a stream finishes. */\nexport interface TextChunkDoneEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  finishReason: string | null\n  usage?: TokenUsage\n}\n\n/** Emitted on stream errors. */\nexport interface TextChunkErrorEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  error: string\n}\n\n/** Emitted when usage metrics are available for text. */\nexport interface TextUsageEvent extends BaseEventContext {\n  requestId: string\n  streamId: string\n  messageId?: string\n  model: string\n  usage: TokenUsage\n}\n\n// ===========================\n// Tool Events\n// ===========================\n\n/** Emitted when tool approval is required. */\nexport interface ToolsApprovalRequestedEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  toolCallId: string\n  toolName: string\n  input: unknown\n  approvalId: string\n}\n\n/** Emitted when user responds to an approval request. */\nexport interface ToolsApprovalRespondedEvent extends BaseEventContext {\n  toolCallId: string\n  approvalId: string\n  approved: boolean\n}\n\n/** Emitted when tool input is available for client execution. */\nexport interface ToolsInputAvailableEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  toolCallId: string\n  toolName: string\n  input: unknown\n}\n\n/** Emitted when a tool call completes with a result. */\nexport interface ToolsCallCompletedEvent extends BaseEventContext {\n  requestId?: string\n  streamId: string\n  messageId?: string\n  toolCallId: string\n  toolName: string\n  result: unknown\n  duration: number\n}\n\n/** Emitted when a client tool result is added. */\nexport interface ToolsResultAddedEvent extends BaseEventContext {\n  toolCallId: string\n  toolName: string\n  output: unknown\n  state: 'output-available' | 'output-error'\n}\n\n/** Emitted when tool call state changes on the client. */\nexport interface ToolsCallUpdatedEvent extends BaseEventContext {\n  streamId: string\n  messageId: string\n  toolCallId: string\n  toolName: string\n  state: ToolCallState\n  arguments: string\n}\n\n// ===========================\n// Summarize Events\n// ===========================\n\n/** Emitted when summarize starts. */\nexport interface SummarizeRequestStartedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  inputLength: number\n}\n\n/** Emitted when summarize completes. */\nexport interface SummarizeRequestCompletedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  inputLength: number\n  outputLength: number\n  duration: number\n}\n\n/** Emitted when summarize usage metrics are available. */\nexport interface SummarizeUsageEvent extends BaseEventContext {\n  requestId: string\n  model: string\n  usage: TokenUsage\n}\n\n// ===========================\n// Image Events\n// ===========================\n\n/** Emitted when an image request starts. */\nexport interface ImageRequestStartedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  prompt: string\n  numberOfImages?: number\n  size?: string\n}\n\n/** Emitted when an image request completes. */\nexport interface ImageRequestCompletedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  images: Array<{ url?: string; b64Json?: string }>\n  duration: number\n}\n\n/** Emitted when image usage metrics are available. */\nexport interface ImageUsageEvent extends BaseEventContext {\n  requestId: string\n  model: string\n  usage: ImageUsage\n}\n\n// ===========================\n// Speech Events\n// ===========================\n\n/** Emitted when a speech request starts. */\nexport interface SpeechRequestStartedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  text: string\n  voice?: string\n  format?: string\n  speed?: number\n}\n\n/** Emitted when a speech request completes. */\nexport interface SpeechRequestCompletedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  audio: string\n  format: string\n  duration: number\n  audioDuration?: number\n  contentType?: string\n}\n\n/** Emitted when speech usage metrics are available. */\nexport interface SpeechUsageEvent extends BaseEventContext {\n  requestId: string\n  model: string\n  usage: TokenUsage\n}\n\n// ===========================\n// Transcription Events\n// ===========================\n\n/** Emitted when a transcription request starts. */\nexport interface TranscriptionRequestStartedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  language?: string\n  prompt?: string\n  responseFormat?: string\n}\n\n/** Emitted when a transcription request completes. */\nexport interface TranscriptionRequestCompletedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  text: string\n  language?: string\n  duration: number\n}\n\n/** Emitted when transcription usage metrics are available. */\nexport interface TranscriptionUsageEvent extends BaseEventContext {\n  requestId: string\n  model: string\n  usage: TokenUsage\n}\n\n// ===========================\n// Video Events\n// ===========================\n\n/** Emitted when a video request starts. */\nexport interface VideoRequestStartedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  requestType: 'create' | 'status' | 'url'\n  jobId?: string\n  prompt?: string\n  size?: string\n  duration?: number\n}\n\n/** Emitted when a video request completes. */\nexport interface VideoRequestCompletedEvent extends BaseEventContext {\n  requestId: string\n  provider: string\n  model: string\n  requestType: 'create' | 'status' | 'url'\n  jobId?: string\n  status?: 'pending' | 'processing' | 'completed' | 'failed'\n  progress?: number\n  url?: string\n  error?: string\n  duration: number\n}\n\n/** Emitted when video usage metrics are available. */\nexport interface VideoUsageEvent extends BaseEventContext {\n  requestId: string\n  model: string\n  usage: TokenUsage\n}\n\n// ===========================\n// Client Events\n// ===========================\n\n/** Emitted when a client is created. */\nexport interface ClientCreatedEvent {\n  clientId: string\n  initialMessageCount: number\n  timestamp: number\n}\n\n/** Emitted when client loading state changes. */\nexport interface ClientLoadingChangedEvent {\n  clientId: string\n  isLoading: boolean\n  timestamp: number\n}\n\n/** Emitted when client error state changes. */\nexport interface ClientErrorChangedEvent {\n  clientId: string\n  error: string | null\n  timestamp: number\n}\n\n/** Emitted when client messages are cleared. */\nexport interface ClientMessagesClearedEvent {\n  clientId: string\n  timestamp: number\n}\n\n/** Emitted when client is reloaded. */\nexport interface ClientReloadedEvent {\n  clientId: string\n  fromMessageIndex: number\n  timestamp: number\n}\n\n/** Emitted when client stops. */\nexport interface ClientStoppedEvent {\n  clientId: string\n  timestamp: number\n}\n\nexport interface AIDevtoolsEventMap {\n  // Text events\n  'tanstack-ai-devtools:text:request:started': TextRequestStartedEvent\n  'tanstack-ai-devtools:text:request:completed': TextRequestCompletedEvent\n  'tanstack-ai-devtools:text:message:created': TextMessageCreatedEvent\n  'tanstack-ai-devtools:text:message:user': TextMessageUserEvent\n  'tanstack-ai-devtools:text:chunk:content': TextChunkContentEvent\n  'tanstack-ai-devtools:text:chunk:tool-call': TextChunkToolCallEvent\n  'tanstack-ai-devtools:text:chunk:tool-result': TextChunkToolResultEvent\n  'tanstack-ai-devtools:text:chunk:thinking': TextChunkThinkingEvent\n  'tanstack-ai-devtools:text:chunk:done': TextChunkDoneEvent\n  'tanstack-ai-devtools:text:chunk:error': TextChunkErrorEvent\n  'tanstack-ai-devtools:text:usage': TextUsageEvent\n\n  // Tool events\n  'tanstack-ai-devtools:tools:approval:requested': ToolsApprovalRequestedEvent\n  'tanstack-ai-devtools:tools:approval:responded': ToolsApprovalRespondedEvent\n  'tanstack-ai-devtools:tools:input:available': ToolsInputAvailableEvent\n  'tanstack-ai-devtools:tools:call:completed': ToolsCallCompletedEvent\n  'tanstack-ai-devtools:tools:result:added': ToolsResultAddedEvent\n  'tanstack-ai-devtools:tools:call:updated': ToolsCallUpdatedEvent\n\n  // Summarize events\n  'tanstack-ai-devtools:summarize:request:started': SummarizeRequestStartedEvent\n  'tanstack-ai-devtools:summarize:request:completed': SummarizeRequestCompletedEvent\n  'tanstack-ai-devtools:summarize:usage': SummarizeUsageEvent\n\n  // Image events\n  'tanstack-ai-devtools:image:request:started': ImageRequestStartedEvent\n  'tanstack-ai-devtools:image:request:completed': ImageRequestCompletedEvent\n  'tanstack-ai-devtools:image:usage': ImageUsageEvent\n\n  // Speech events\n  'tanstack-ai-devtools:speech:request:started': SpeechRequestStartedEvent\n  'tanstack-ai-devtools:speech:request:completed': SpeechRequestCompletedEvent\n  'tanstack-ai-devtools:speech:usage': SpeechUsageEvent\n\n  // Transcription events\n  'tanstack-ai-devtools:transcription:request:started': TranscriptionRequestStartedEvent\n  'tanstack-ai-devtools:transcription:request:completed': TranscriptionRequestCompletedEvent\n  'tanstack-ai-devtools:transcription:usage': TranscriptionUsageEvent\n\n  // Video events\n  'tanstack-ai-devtools:video:request:started': VideoRequestStartedEvent\n  'tanstack-ai-devtools:video:request:completed': VideoRequestCompletedEvent\n  'tanstack-ai-devtools:video:usage': VideoUsageEvent\n\n  // Client events\n  'tanstack-ai-devtools:client:created': ClientCreatedEvent\n  'tanstack-ai-devtools:client:loading:changed': ClientLoadingChangedEvent\n  'tanstack-ai-devtools:client:error:changed': ClientErrorChangedEvent\n  'tanstack-ai-devtools:client:messages:cleared': ClientMessagesClearedEvent\n  'tanstack-ai-devtools:client:reloaded': ClientReloadedEvent\n  'tanstack-ai-devtools:client:stopped': ClientStoppedEvent\n}\n\nclass AiEventClient extends EventClient<AIDevtoolsEventMap> {\n  constructor() {\n    super({\n      pluginId: 'tanstack-ai-devtools',\n    })\n  }\n}\n\nconst aiEventClient = new AiEventClient()\n\nexport { aiEventClient }\n"],"names":[],"mappings":";AAseA,MAAM,sBAAsB,YAAgC;AAAA,EAC1D,cAAc;AACZ,UAAM;AAAA,MACJ,UAAU;AAAA,IAAA,CACX;AAAA,EACH;AACF;AAEA,MAAM,gBAAgB,IAAI,cAAA;"}